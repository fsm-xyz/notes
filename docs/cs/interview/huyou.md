一、高并发
核心目标： 系统能够同时处理大量的用户请求或操作。

关键挑战： 当海量请求瞬间涌向系统（如秒杀活动、明星官宣、突发新闻）时，如何避免系统崩溃、响应缓慢或超时。

衡量指标：

QPS： 每秒查询率。系统每秒能成功处理的请求数量。

TPS： 每秒事务数。系统每秒能成功处理的事务数量（一个事务可能包含多个请求）。

并发用户数： 同一时刻与系统进行交互（发送请求、等待响应）的用户数量。

响应时间： 系统处理一个请求并返回结果所花费的时间（平均、P95/P99）。

核心解决思路与技术：

负载均衡： 将涌入的流量分发到多个服务器或实例上处理，避免单点过载。常用方案：Nginx, HAProxy, F5, 云LB (ELB/CLB/ALB), DNS轮询。

应用层优化：

异步处理： 将耗时操作（如发送邮件、生成报表）放入消息队列（如Kafka, RabbitMQ, RocketMQ），快速响应用户，后台异步消费处理。削峰填谷的关键手段。

缓存： 将频繁读取的热点数据（如商品信息、用户资料）存放在高速缓存（如Redis, Memcached）中，极大减少对慢速数据库的访问。

连接池： 复用数据库、Redis等资源的连接，避免频繁创建销毁连接的开销。

代码优化： 减少不必要的计算、数据库查询、I/O操作；使用高效算法和数据结构。

数据层优化：

数据库读写分离： 主库负责写，多个从库负责读，分担读压力。

分库分表： 将单个大库/表按业务或规则（如用户ID取模）拆分成多个小库/表，分散存储和访问压力。需要解决分布式事务、跨库查询等挑战。

NoSQL数据库： 对于非强事务、结构灵活或海量数据的场景（如用户行为日志），选用合适的NoSQL（如MongoDB, Cassandra, Elasticsearch）能提供更好的并发读写能力。

限流 & 熔断 & 降级：

限流： 控制进入系统的请求速率，超过阈值的请求直接拒绝或排队（如令牌桶、漏桶算法），保护系统不被压垮。常用库：Guava RateLimiter, Sentinel。

熔断： 当下游服务（如某个数据库或接口）故障或响应过慢时，暂时停止调用该服务，避免资源耗尽和级联故障，快速失败并给上游返回预设响应（如默认值、错误提示）。常用库：Hystrix, Sentinel, Resilience4j。

降级： 在系统压力过大或部分功能故障时，暂时关闭非核心功能（如商品评论、推荐），释放资源保证核心功能（如下单、支付）可用。提前准备降级预案。

静态资源优化： 使用CDN分发图片、JS、CSS等静态文件，减轻应用服务器压力，加快用户访问速度。

水平扩展： 通过增加服务器/容器实例数量来提升整体处理能力。需要应用本身是无状态的或状态能外部化存储（如存到Redis），才能方便扩展。



二、高可用
核心目标： 系统能够提供持续可访问的服务，将停机中断时间降到最低（如达到99.9%， 99.99%， 99.999%的可用性）。

关键挑战： 应对硬件故障、软件缺陷、网络中断、人为错误、自然灾害等导致的服务不可用。

衡量指标：

可用性百分比： 系统正常运行时间占总时间的比例。例如：

99.9% - 一年停机时间约8.76小时

99.99% - 一年停机时间约52.6分钟

99.999% - 一年停机时间约5.26分钟

MTBF： 平均故障间隔时间。

MTTR： 平均修复时间。高可用追求极低的MTTR。

核心解决思路与技术：

冗余：

服务器冗余： 部署多台应用服务器，一台宕机，其他继续服务。

数据库冗余： 主备复制（Master-Slave Replication）、主主复制（Master-Master Replication）、分布式数据库（如TiDB, CockroachDB）。主库故障时能快速切换到备库。

存储冗余： 使用RAID、分布式存储（如Ceph, HDFS）、云存储的多副本机制，防止单块磁盘或节点故障导致数据丢失。

网络冗余： 多线路接入、多交换机、多路由器，避免单点网络故障。

多机房/多地域部署： 在物理隔离的不同机房或云区域部署服务，防止单个机房火灾、断电、网络中断等影响全局。通常结合负载均衡和DNS实现流量切换。

故障转移：

自动故障转移： 当检测到主节点故障（心跳检测超时）时，自动将流量切换到备用节点。需要解决脑裂问题。常用方案：Keepalived + VIP, Redis Sentinel, ZooKeeper/etcd选主。

手动故障转移： 在确认故障后，由运维人员手动执行切换流程。通常作为自动故障转移的补充或用于计划内维护。

负载均衡： 不仅用于高并发，也是高可用的关键组件。它能自动将流量从故障节点移除，只分发到健康节点。

健康检查： 负载均衡器或服务注册中心（如Consul, Nacos, Eureka）持续检查后端实例的健康状态（如HTTP状态码、TCP端口连通性），及时剔除不健康的实例。

监控告警： 全面的监控（系统指标、应用性能、业务指标、日志）和及时的告警（邮件、短信、钉钉、电话），让运维团队能快速发现、定位、响应问题，缩短MTTR。

容灾： 建立异地容灾中心，在发生区域性灾难时能接管生产流量。通常涉及数据同步和应用部署。

优雅启停： 应用在关闭前完成当前请求处理并拒绝新请求；在启动完成后再接收流量，避免服务中断或请求错误。

混沌工程： 在生产环境的受控范围内主动注入故障（如杀死进程、断网、填满磁盘），验证系统的容错能力，提前发现弱点并修复。




高并发:
    接入层: 负载均衡分配流量 Nginx, HAProxy, F5, 云LB, DNS轮询
    业务层: 微服务拆分, 缓存, 异步处理/消息队列, 业务逻辑算法优化，连接池
    数据库: 读写分离, 分表分库, 集群， NoSQL，分布式数据库
    其他: 限流, 熔断, 降级, CDN, 无状态服务水平扩展

    寻找性能瓶颈点

高可用:
    冗余    资源备用，主备资源切换
        服务器冗余，数据库冗余，存储冗余，网络冗余，多机房/多地域部署
    故障转移
        自动故障转移 当检测到主节点故障（心跳检测超时）时，自动将流量切换到备用节点  Keepalived + VIP, Redis Sentinel, ZooKeeper/etcd
        手动故障转移
    负载均衡
        keepalived+vip, lvs 主备切换
    健康检查
    监控告警
    容灾
    优雅启停
    混沌工程

负载均衡 冗余 异步/消息队列 限流/熔断/降级

而是出了问题多久能解决，给客户带来最小化的损失

